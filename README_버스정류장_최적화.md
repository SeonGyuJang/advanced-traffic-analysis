# 세종시 버스정류장 최적화 분석

## 📋 프로젝트 개요

정수계획법(Integer Programming)을 활용한 세종시 버스정류장 최적 위치 선정 시스템입니다.
버스카드 이력 데이터(2024-2025)를 기반으로 수요를 분석하고, 서비스가 부족한 지역에 신규 정류장을 최적 배치하는 솔루션을 제공합니다.

## 🎯 주요 기능

### 1. 정류장별 수요 분석
- 행정구역별 승하차 데이터를 정류장 단위로 변환
- 승차, 하차, 환승 데이터 통합 분석
- 기간별 수요 추이 분석

### 2. 정수계획법 기반 최적화
- **목적함수**: 가중 수요 최대화
  - 수요(60%) + 환승(20%) + 거리(20%)
- **제약조건**:
  - 신규 정류장 개수 제한
  - 커버리지 반경 (기본 0.5km)
- **알고리즘**: CBC(Coin-or Branch and Cut) Solver

### 3. 인터랙티브 대시보드
- 기간 선택 필터
- 실시간 지도 시각화 (Folium)
- 수요 트렌드 차트 (Plotly)
- 정류장 상세 정보

## 📊 분석 결과 (2024-2025)

### 주요 지표
| 구분 | 값 |
|------|-----|
| 기존 정류장 | 1,214개 |
| 서비스 부족 지역 | 5개 |
| 신규 추천 정류장 | 5개 |
| 총 커버 수요 | 4,512,008명 |
| 분석 데이터 | 14,859건 |

### 신규 정류장 추천 목록

| 우선순위 | 행정구역 | 예상 수요 | 커버 수요 | 최단거리 |
|---------|---------|----------|----------|---------|
| 1 | 금남면 | 971,368명 | 971,368명 | 0.75km |
| 2 | 반곡동 | 2,417,064명 | 2,417,064명 | 0.57km |
| 3 | 소정면 | 75,382명 | 75,382명 | 1.04km |
| 4 | 장군면 | 755,785명 | 755,785명 | 0.53km |
| 5 | 전동면 | 292,409명 | 292,409명 | 0.86km |

### 최적화 효과
- **커버리지 개선**: 78.9% → 100% (+21.1%p)
- **미커버 수요 해소**: 4,512,008명
- **목적함수 값**: 2,645,418.24

## 🚀 사용 방법

### 1. 환경 설정

```bash
# 필수 패키지 설치
pip install pandas numpy matplotlib seaborn pulp folium plotly streamlit streamlit-folium
```

### 2. 최적화 분석 실행

```bash
python 버스정류장_최적화_분석.py
```

**출력 파일**:
- `최적화_신규정류장.csv` - 신규 정류장 추천 목록
- `서비스부족지역.csv` - 서비스 부족 지역 목록
- `최적화_분석_보고서.json` - 종합 분석 보고서

### 3. 시각화 생성

```bash
python 시각화_생성.py
```

**출력 파일**:
- `최적화_인터랙티브_지도.html` - 인터랙티브 지도
- `최적화_종합_시각화.png` - 종합 시각화 이미지
- `시계열_차트.html` - 시계열 분석 차트
- `지역별_차트.html` - 지역별 분석 차트

### 4. 대시보드 실행

```bash
streamlit run 대시보드.py
```

브라우저에서 `http://localhost:8501` 접속

## 📁 프로젝트 구조

```
advanced-traffic-analysis/
├── data/
│   ├── 세종도시교통공사_버스정류장_시설현황_20210924.csv
│   ├── 지역별승하차_통합데이터.csv
│   └── 행정구역_중심좌표.csv
├── 버스정류장_최적화_분석.py      # 정수계획법 최적화 분석
├── 시각화_생성.py                  # 정적 시각화 생성
├── 대시보드.py                      # Streamlit 대시보드
├── 최적화_신규정류장.csv           # 분석 결과
├── 최적화_분석_보고서.json         # 분석 보고서
├── 최적화_인터랙티브_지도.html     # 인터랙티브 지도
└── README_버스정류장_최적화.md     # 본 문서
```

## 🔧 파라미터 설정

### 버스정류장_최적화_분석.py

```python
COVERAGE_RADIUS = 0.5    # 커버리지 반경 (km)
MAX_NEW_STATIONS = 10    # 최대 신규 정류장 개수

# 분석 기간 설정
optimizer = BusStationOptimizer(
    start_date='2024-01-01',
    end_date='2025-12-05'
)
```

### 가중치 설정

```python
# 수요 가중치
weights = 0.60 * demand_norm + 0.20 * transfer_norm + 0.20 * distance_norm
```

## 📈 대시보드 기능

### 1. 주요 지표 (KPI)
- 기존 정류장 개수
- 총 이용객 수 (기간별)
- 신규 추천 정류장 개수
- 서비스 부족 지역 개수

### 2. 지도 시각화
- **기존 정류장**: 보라색 원
- **신규 추천 정류장**: 빨간색 마커
- **커버리지 반경**: 투명한 원 (0.5km)
- **레이어 컨트롤**: 각 레이어 개별 on/off

### 3. 수요 분석
- **시계열 분석**: 일별 승하차 및 환승 추이
- **지역별 분석**: 행정구역별 총 이용객
- **환승 분석**: 환승률 및 패턴

### 4. 최적화 결과
- 분석 정보 요약
- 커버리지 개선 효과
- 신규 정류장 상세 정보

## 🔍 알고리즘 상세

### 정수계획법 모델

**결정 변수**:
- `x[i]`: 위치 i에 정류장을 설치할지 여부 (0 또는 1)
- `y[i]`: 지역 i가 커버되는지 여부 (0 또는 1)

**목적함수**:
```
Maximize: Σ (demand[i] × weight[i] × y[i])
```

**제약조건**:
1. `Σ x[i] ≤ MAX_NEW_STATIONS` (정류장 개수 제한)
2. `y[i] ≤ Σ (coverage[i][j] × x[j])` (커버리지 제약)

**커버리지 행렬**:
```python
coverage[i][j] = 1 if distance(i, j) ≤ COVERAGE_RADIUS else 0
```

## 📊 데이터 설명

### 입력 데이터

1. **버스정류장_시설현황**
   - 정류소ID, 정류소명
   - 위도, 경도
   - 노선 정보

2. **지역별승하차_통합데이터**
   - 날짜 (2024-01-01 ~ 2025-12-05)
   - 행정구역
   - 승차, 하차, 환승 인원

3. **행정구역_중심좌표**
   - 행정구역명
   - 중심 위도, 경도

### 출력 데이터

1. **최적화_신규정류장.csv**
   ```
   우선순위, 행정구역, 총_이용객, 커버_수요, 위도, 경도
   ```

2. **최적화_분석_보고서.json**
   ```json
   {
     "분석일시": "...",
     "분석기간": {...},
     "기존_정류장": {...},
     "서비스_부족_지역": {...},
     "최적화_결과": {...}
   }
   ```

## 🎨 시각화 예시

### 1. 인터랙티브 지도
- Folium 기반 지도
- 정류장 마커 클릭 시 상세 정보 표시
- 커버리지 반경 시각화
- 레이어 컨트롤

### 2. 종합 시각화
- 일별 승하차 추이
- 지역별 총 이용객 (상위 15개)
- 신규 정류장 수요 분석
- 환승률 분석

### 3. 대시보드 차트
- Plotly 인터랙티브 차트
- 확대/축소, 팬 기능
- 호버 정보 표시
- 다운로드 기능

## 💡 활용 방안

### 1. 교통 계획
- 신규 버스 노선 계획
- 정류장 입지 선정
- 서비스 격차 해소

### 2. 정책 수립
- 교통 복지 정책
- 예산 배분 우선순위
- 지역 균형 발전

### 3. 추가 분석
- 시간대별 수요 패턴
- 계절별 변동 분석
- 노선별 효율성 평가

## 🔄 향후 개선 사항

1. **실시간 데이터 연동**
   - API 연동
   - 자동 업데이트

2. **고급 최적화**
   - 다목적 최적화
   - 시간대별 최적화
   - 예산 제약 추가

3. **머신러닝 통합**
   - 수요 예측 모델
   - 이상치 탐지
   - 클러스터링

4. **모바일 앱**
   - 실시간 정보 제공
   - 위치 기반 서비스

## 📝 참고 자료

- [PuLP Documentation](https://coin-or.github.io/pulp/)
- [Streamlit Documentation](https://docs.streamlit.io/)
- [Folium Documentation](https://python-visualization.github.io/folium/)

## 👥 기여

이 프로젝트는 세종시 교통 데이터를 기반으로 개발되었습니다.

## 📄 라이선스

MIT License

---

**문의**: Advanced Traffic Analysis Team
**최종 업데이트**: 2025-12-11
