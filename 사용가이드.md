# 버스정류장 최적화 분석 - 빠른 시작 가이드

## 🚀 빠른 시작

### 1단계: 환경 설정
```bash
# 필수 패키지 설치
pip install pandas numpy matplotlib seaborn pulp folium plotly streamlit streamlit-folium
```

### 2단계: 최적화 분석 실행
```bash
python 버스정류장_최적화_분석.py
```

**실행 결과**:
```
====================================================================================================
                              세종시 버스정류장 최적화 분석 (정수계획법)
====================================================================================================

✓ 기존 정류장: 1,214개
✓ 승하차 데이터: 14,859건
✓ 분석 기간: 2024-01-01 ~ 2025-12-05

✓ 서비스 부족 지역: 5개
✓ 선정된 신규 정류장: 5개
✓ 총 커버 수요: 4,512,008명

✓ 신규 정류장 결과 저장: 최적화_신규정류장.csv
✓ 서비스 부족 지역 저장: 서비스부족지역.csv
✓ 분석 보고서 생성 완료: 최적화_분석_보고서.json
```

### 3단계: 시각화 생성
```bash
python 시각화_생성.py
```

**생성 파일**:
- `최적화_인터랙티브_지도.html` - 웹브라우저에서 열기
- `최적화_종합_시각화.png` - 이미지 뷰어로 열기
- `시계열_차트.html` - 웹브라우저에서 열기
- `지역별_차트.html` - 웹브라우저에서 열기

### 4단계: 대시보드 실행
```bash
streamlit run 대시보드.py
```

브라우저가 자동으로 열리며 `http://localhost:8501`에 접속됩니다.

## 📱 대시보드 사용법

### 사이드바 (왼쪽)
1. **분석 기간 선택**
   - 시작일과 종료일을 선택하여 원하는 기간의 데이터 분석

2. **최적화 파라미터**
   - 커버리지 반경: 정류장이 커버하는 범위 (기본 0.5km)
   - 최대 신규 정류장 개수: 추천할 정류장 수 (기본 10개)

### 메인 화면

#### 1. 주요 지표
- 기존 정류장 개수
- 총 이용객 수
- 추천 신규 정류장
- 서비스 부족 지역

#### 2. 지도 시각화
- **레이어 컨트롤** (우측 상단): 각 레이어 on/off
  - 기존 정류장 (보라색 점)
  - 신규 추천 정류장 (빨간 마커)
  - 서비스 부족 지역 (빨간 점)
- **마커 클릭**: 상세 정보 팝업
- **줌/팬**: 마우스 휠 및 드래그

#### 3. 수요 분석 탭
- **시계열 분석**: 일별 승하차/환승 추이
- **지역별 분석**: 행정구역별 이용객 순위
- **환승 분석**: 환승률 및 패턴

## 🔧 파라미터 커스터마이징

### 분석 기간 변경
```python
# 버스정류장_최적화_분석.py 파일의 메인 섹션 수정
optimizer = BusStationOptimizer(
    start_date='2024-06-01',  # 원하는 시작일
    end_date='2025-12-05'     # 원하는 종료일
)
```

### 커버리지 반경 변경
```python
# 파일 상단 설정 부분 수정
COVERAGE_RADIUS = 0.7  # 0.5km → 0.7km로 변경
```

### 신규 정류장 개수 변경
```python
# 파일 상단 설정 부분 수정
MAX_NEW_STATIONS = 15  # 10개 → 15개로 변경
```

### 가중치 변경
```python
# optimize_new_stations 함수 내부 수정
weights = 0.50 * demand_norm + 0.30 * transfer_norm + 0.20 * distance_norm
# 수요(50%) + 환승(30%) + 거리(20%)로 변경
```

## 📊 결과 파일 해석

### 최적화_신규정류장.csv
```csv
우선순위,행정구역,총_이용객,커버_수요,위도,경도
1,금남면,971368,971368,36.454705,127.292289
```

- **우선순위**: 추천 순위 (1이 최우선)
- **총_이용객**: 해당 지역의 총 수요
- **커버_수요**: 신규 정류장이 커버할 수 있는 총 수요
- **위도/경도**: 추천 위치 좌표

### 최적화_분석_보고서.json
```json
{
  "분석일시": "2025-12-11 18:19:08",
  "기존_정류장": {
    "개수": 1214,
    "총_수요": 47211790
  },
  "최적화_결과": {
    "신규_정류장_개수": 5,
    "커버_수요": 4512008
  }
}
```

## 🎯 활용 시나리오

### 시나리오 1: 특정 기간 분석
```python
# 여름 시즌 (6-8월) 분석
optimizer = BusStationOptimizer(
    start_date='2024-06-01',
    end_date='2024-08-31'
)
```

### 시나리오 2: 더 많은 정류장 추천
```python
# 최대 20개 정류장 추천
MAX_NEW_STATIONS = 20
```

### 시나리오 3: 환승 중심 최적화
```python
# 환승 가중치를 높게 설정
weights = 0.40 * demand_norm + 0.50 * transfer_norm + 0.10 * distance_norm
```

## 🐛 문제 해결

### Q1: 패키지 설치 오류
```bash
# 가상환경 생성 후 설치
python -m venv venv
source venv/bin/activate  # Linux/Mac
# or
venv\Scripts\activate  # Windows

pip install -r requirements.txt
```

### Q2: 한글 폰트 깨짐
```python
# 시스템에 한글 폰트 설치
# Ubuntu/Debian
sudo apt-get install fonts-nanum

# 또는 스크립트에서 폰트 경로 직접 지정
plt.rcParams['font.family'] = 'NanumGothic'
```

### Q3: 대시보드가 열리지 않음
```bash
# 포트 변경
streamlit run 대시보드.py --server.port 8502
```

### Q4: 최적화가 너무 오래 걸림
```python
# 데이터 샘플링 또는 커버리지 반경 증가
COVERAGE_RADIUS = 1.0  # 반경을 늘려 계산 복잡도 감소
```

## 📞 지원

문제가 발생하면 다음을 확인하세요:
1. 모든 데이터 파일이 `data/` 폴더에 있는지
2. 필요한 패키지가 모두 설치되었는지
3. Python 버전이 3.8 이상인지

---

**Happy Analyzing! 🚌📊**
